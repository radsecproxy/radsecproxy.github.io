<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Fri Jul  5 17:15:33 2024 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>radsecproxy.conf</title>

</head>
<body>

<h1 align="center">radsecproxy.conf</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFIGURATION SYNTAX">CONFIGURATION SYNTAX</a><br>
<a href="#BASIC OPTIONS">BASIC OPTIONS</a><br>
<a href="#BLOCKS">BLOCKS</a><br>
<a href="#CLIENT BLOCK">CLIENT BLOCK</a><br>
<a href="#SERVER BLOCK">SERVER BLOCK</a><br>
<a href="#REALM BLOCK">REALM BLOCK</a><br>
<a href="#REALM BLOCK NAMES AND MATCHING">REALM BLOCK NAMES AND MATCHING</a><br>
<a href="#SERVER SELECTION">SERVER SELECTION</a><br>
<a href="#TLS BLOCK">TLS BLOCK</a><br>
<a href="#REWRITE BLOCK">REWRITE BLOCK</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em">radsecproxy.conf
&minus; Radsec proxy configuration file</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">When the proxy
server starts, it will first check the command line
arguments, and then read the configuration file. Normally
radsecproxy will read the configuration file
<i>/usr/local/etc/radsecproxy.conf</i>. The command line
<b>&minus;c</b> option can be used to instead read an
alternate file (see <b>radsecproxy</b>(8) for details).</p>

<p style="margin-left:9%; margin-top: 1em">If the
configuration file can not be found, the proxy will exit
with an error message. Note that there is also an include
facility so that any configuration file may include other
configuration files. The proxy will also exit on
configuration errors.</p>

<h2>CONFIGURATION SYNTAX
<a name="CONFIGURATION SYNTAX"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">When the
configuration file is processed, whitespace (spaces and
tabs) are generally ignored. For each line, leading and
trailing whitespace are ignored. A line is ignored if it is
empty, only consists of whitespace, or if the first
non-whitespace character is a #. The configuration is
generally case insensitive, but in some cases the option
values (see below) are not.</p>

<p style="margin-left:9%; margin-top: 1em">There are two
types of configuration structures than can be used. The
first and simplest are lines on the format <i>option
value</i>. That is, an option name, see below for a list of
valid options, followed by whitespace (at least one space or
tab character), followed by a value. Note that if the value
contains whitespace, then it must be quoted using
&quot;&quot; or &rsquo;&rsquo;. Any whitespace in front of
the option or after the value will be ignored.</p>

<p style="margin-left:9%; margin-top: 1em">The other type
of structure is a block. A block spans at least two lines,
and has the format:</p>

<p style="margin-left:18%; margin-top: 1em">blocktype name
{</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="87%">


<p>option value</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="87%">


<p>option value</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="87%">


<p>...</p></td></tr>
</table>

<p style="margin-left:18%;">}</p>

<p style="margin-left:9%; margin-top: 1em">That is, some
blocktype, see below for a list of the different block
types, and then enclosed in braces you have zero or more
lines that each have the previously described <i>option
value</i> format. Different block types have different rules
for which options can be specified, they are listed below.
The rules regarding white space, comments and quotes are as
above. Hence you may do things like:</p>

<p style="margin-left:18%; margin-top: 1em">blocktype name
{ <br>
# option value <br>
option &quot;value with space&quot; <br>
... <br>
}</p>

<p style="margin-left:9%; margin-top: 1em">Option value
characters can also be written in hex for options requiring
a string type value. A % character followed by two
hexadecimal digits will be replaced by its byte value.
Longer hex strings can be escaped with %%. In this case all
following hexadecimal digit pairs will be replace by byte
values until the first non-hex character. If a % is used
without two following hexadecimal digits, the % and the
following characters are used as written. If you want to
write a % and not use this decoding, you may of course write
% in hex; i.e., %25. As %00 would terminate a string, this
value is not converted in most cases, except when used with
rewrite statements or secrets.</p>

<p style="margin-left:9%; margin-top: 1em">Some options
allow or require the use of regular expressions, denoted as
<i>regex</i>. The POSIX extended RE system is used, see
<b>re_format</b>(7).</p>

<p style="margin-left:9%; margin-top: 1em">There is one
special option that can be used both as a basic option and
inside all blocks. That is the option <i>Include</i> where
the value specifies files to be included. The value can be a
single file, or it can use normal shell globbing to specify
multiple files, e.g.:</p>

<p style="margin-left:18%; margin-top: 1em">include
/usr/local/etc/radsecproxy.conf.d/*.conf</p>

<p style="margin-left:9%; margin-top: 1em">The files are
sorted alphabetically. Included files are read in the order
they are specified, when reaching the end of a file, the
next file is read. When reaching the end of the last
included file, the proxy returns to read the next line
following the <i>Include</i> option. Included files may
again include other files.</p>

<h2>BASIC OPTIONS
<a name="BASIC OPTIONS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The following
basic options may be specified in the configuration file.
Note that blocktypes and options inside blocks are discussed
later. Note that none of these options are required, and
indeed in many cases they are not needed. Note that you
should specify each at most once. The behaviour with
multiple occurrences is undefined.</p>

<p style="margin-left:9%; margin-top: 1em"><b>PidFile</b>
<i>file</i></p>

<p style="margin-left:18%;">The PidFile option specifies
the name of a <i>file</i> to which the process id (PID) will
be written. This is overridden by the <b>&minus;i</b>
command line option. There is no default value for the
PidFile option.</p>

<p style="margin-left:9%; margin-top: 1em"><b>LogLevel</b>
1-5</p>

<p style="margin-left:18%;">This option specifies the debug
level. It must be set to 1, 2, 3, 4 or 5, where 1 logs only
serious errors, and 5 logs everything. The default is 2
which logs errors, warnings and a few informational
messages. Note that the command line option <b>&minus;d</b>
overrides this.</p>


<p style="margin-left:9%; margin-top: 1em"><b>LogDestination
(</b><i>file</i><b>|</b><i>syslog</i><b>)</b></p>

<p style="margin-left:18%;">This specifies where the log
messages should go. By default the messages go to syslog
with facility <b>LOG_DAEMON</b>. Using this option you can
specify another syslog facility, or you may specify that
logging should be to a particular file, not using syslog.
The value must be either a file URL like
<b>file:///path/to/your/logfile.log</b> or a syslog URL
using the syntax: <b>x&minus;syslog:///FACILITY</b> where
<b>FACILITY</b> must be one of <b>LOG_DAEMON</b>,
<b>LOG_MAIL</b>, <b>LOG_USER</b>, <b>LOG_LOCAL0</b>,
<b>LOG_LOCAL1</b>, <b>LOG_LOCAL2</b>, <b>LOG_LOCAL3</b>,
<b>LOG_LOCAL4</b>, <b>LOG_LOCAL5</b>, <b>LOG_LOCAL6</b>or
<b>LOG_LOCAL7</b>. You may omit the facility from the URL to
specify logging to the default facility, but this is not
very useful since this is the default log destination. Note
that this option is ignored if <b>&minus;f</b> is specified
on the command line.</p>

<p style="margin-left:9%; margin-top: 1em"><b>LogThreadId
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">This can be set to on to
include the thread-id in the log messages (useful for
debugging).</p>


<p style="margin-left:9%; margin-top: 1em"><b>LogFullUsername
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">This can be set to off to only
log the realm in Access-Accept/Reject log messages (for
privacy).</p>

<p style="margin-left:9%; margin-top: 1em"><b>LogMAC</b>
<i>opt</i></p>

<p style="margin-left:18%;">The LogMAC option can be used
to control if and how Calling-Station-Id (the users Ethernet
MAC address) is being logged. It can be set to one of
<b>Static</b>, <b>Original</b>, <b>VendorHashed</b>,
<b>VendorKeyHashed</b>, <b>FullyHashed</b> or
<b>FullyKeyHashed</b>. The default value for LogMAC is
<b>Original</b>.</p>

<p style="margin-left:18%; margin-top: 1em">See
<i>radsecproxy.conf&minus;example</i> for details.</p>

<p style="margin-left:9%; margin-top: 1em"><b>LogKey</b>
<i>key</i></p>

<p style="margin-left:18%;">The LogKey option is used to
specify the <i>key</i> to use when producing HMAC&rsquo;s as
an effect of specifying <b>VendorKeyHashed</b> or
<b>FullyKeyHashed</b> for the LogMAC option.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FTicksReporting</b>
<i>fticks</i></p>

<p style="margin-left:18%;">The FTicksReporting option is
used to enable F-Ticks logging and can be set to
<b>None</b>, <b>Basic</b> or <b>Full.</b> Its default value
is <b>None</b>. If FTicksReporting is set to anything other
than <b>None</b>, note that the default value for
<b>FTicksMAC</b> needs <b>FTicksKey</b> to be set.</p>

<p style="margin-left:18%; margin-top: 1em">See
<i>radsecproxy.conf&minus;example</i> for details.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FTicksMAC</b>
<i>opt</i></p>

<p style="margin-left:18%;">The FTicksMAC option has the
same function as LogMAC for FTicks. The default for
FTicksMAC is <b>VendorKeyHashed</b> which needs
<b>FTicksKey</b> to be set.</p>

<p style="margin-left:18%; margin-top: 1em">Before choosing
any of <b>Original</b>, <b>FullyHashed</b> or
<b>VendorHashed</b>, consider the implications for user
privacy when MAC addresses are collected. How will the logs
be stored, transferred and accessed?</p>


<p style="margin-left:9%; margin-top: 1em"><b>FTicksKey</b>
<i>key</i></p>

<p style="margin-left:18%;">The FTicksKey option has the
same function as LogKey for Fticks.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FTicksSyslogFacility</b>
<i>syslog</i></p>

<p style="margin-left:18%;">The FTicksSyslogFacility option
is used to specify a dedicated syslog facility for F-Ticks
messages. This allows for easier filtering of F-Ticks
messages. If no FTicksSyslogFacility option is given,
F-Ticks messages are written to what the
<b>LogDestination</b> option specifies.</p>

<p style="margin-left:18%; margin-top: 1em">F-Ticks
messages are always logged using the log level
<b>LOG_DEBUG</b>. Note that specifying a file in
FTicksSyslogFacility (using the file:/// prefix) is not
supported.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FTicksPrefix</b>
<i>prefix</i></p>

<p style="margin-left:18%;">The FTicksPrefix option is used
to set the <i>prefix</i> printed in F-Ticks messages. This
allows for use of F-Ticks messages in non-eduroam
environments. If no FTicksPrefix option is given, it
defaults to the prefix used for eduroam
(<i>F&minus;TICKS/eduroam/1.0</i>).</p>

<p style="margin-left:9%; margin-top: 1em"><b>ListenUDP
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
ListenTCP
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
ListenTLS
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
ListenDTLS
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>]</b></p>

<p style="margin-left:18%;">Listen for the address and port
for the respective protocol. Normally the proxy will listen
to the standard ports if configured to handle clients with
the respective protocol. The default ports are 1812 for
<b>UDP</b> and <b>TCP</b> and 2083 for <b>TLS</b> and
<b>DTLS</b>. On most systems it will do this for all of the
system&rsquo;s IP addresses (both IPv4 and IPv6). On some
systems however, it may respond to only IPv4 or only IPv6.
To specify an alternate port you may use a value on the form
*:<i>port</i> where <i>port</i> is any valid port number. If
you also want to specify a specific <i>address</i> you can
do e.g. 192.168.1.1:1812 or [2001:db8::1]:1812. The port may
be omitted if you want the default one. Note that you must
use brackets around the IPv6 address. These options may be
specified multiple times to listen to multiple addresses
and/or ports for each protocol.</p>

<p style="margin-left:9%; margin-top: 1em"><b>SourceUDP
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
SourceTCP
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
SourceTLS
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>] <br>
SourceDTLS
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>]</b></p>

<p style="margin-left:18%;">This can be used to specify
source address and/or source port that the proxy will use
for connecting to clients to send messages (e.g. Access
Request). The same syntax as for <b>Listen...</b>
applies.</p>

<p style="margin-left:9%; margin-top: 1em"><b>TTLAttribute
(</b><i>attr</i><b>|</b><i>vendor</i><b>:</b><i>attr</i><b>)</b></p>

<p style="margin-left:18%;">This can be used to change the
default TTL attribute. Only change this if you know what you
are doing. The syntax is either a numerical value denoting
the TTL attribute, or two numerical values separated by
column specifying a vendor attribute.</p>

<p style="margin-left:9%; margin-top: 1em"><b>AddTTL</b>
1-255</p>

<p style="margin-left:18%;">If a TTL attribute is present,
the proxy will decrement the value and discard the message
if zero. Normally the proxy does nothing if no TTL attribute
is present. If you use the AddTTL option with a value 1-255,
the proxy will, when forwarding a message with no TTL
attribute, add one with the specified value. Note that this
option can also be specified for a client/server which will
override this setting when forwarding a message to that
client/server.</p>


<p style="margin-left:9%; margin-top: 1em"><b>LoopPrevention
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">When this is enabled (on), a
request will never be sent to a server named the same as the
client it was received from. I.e., the names of the client
block and the server block are compared. Note that this only
gives limited protection against loops. It can be used as a
basic option and inside server blocks where it overrides the
basic setting.</p>

<p style="margin-left:9%; margin-top: 1em"><b>IPv4Only
(</b>on<b>|</b>off<b>) <br>
IPv6Only (</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enabling IPv4Only or IPv6Only
(on) makes radsecproxy resolve DNS names to the
corresponding address family only, and not the other. This
is done for both clients and servers. At most one of
IPv4Only and IPv6Only can be enabled. Note that this can be
overridden in client and server blocks, see below.</p>

<p style="margin-left:9%; margin-top: 1em"><b>SNI
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Server Name Indication (SNI) is
an extension to the TLS protocol. It allows a client to
indicate which hostname it is trying to connect to at the
start of the TLS handshake. Enabling this will use the
extension for all TLS and DTLS servers which specify a
hostname (not IP address). This can be overridden in server
blocks, see below.</p>

<p style="margin-left:9%; margin-top: 1em"><b>VerifyEAP
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">A radius proxy is mostly
agnostic to the contents of the attributes within a radius
message and forwards them as-is. However wrong EAP
attributes can lead to bad user experience. Thus radsecproxy
checks the content length of the contained EAP message and
denies the access-request if it doesn&rsquo;t match the
attribute length. In case malformatted EAP attributes are
inentional, this behaviour can be disabled (default on).</p>

<p style="margin-left:9%; margin-top: 1em"><b>Include</b>
<i>file</i></p>

<p style="margin-left:18%;">This is not a normal
configuration option; it can be specified multiple times. It
can both be used as a basic option and inside blocks. For
the full description, see the configuration syntax section
above.</p>

<h2>BLOCKS
<a name="BLOCKS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">There are five
types of blocks, they are <b>client</b>, <b>server</b>,
<b>realm</b>, <b>tls</b> and <b>rewrite</b>. At least one
instance of each of <b>client</b> and <b>realm</b> is
required for the proxy to do anything useful, and it will
exit if none are configured. The <b>tls</b> block is
required if at least one TLS/DTLS client or server is
configured. Note that there can be multiple blocks for each
type. For each type, the block names should be unique. The
behaviour with multiple occurrences of the same name for the
same block type is undefined. Also note that some block
option values may reference a block by name, in which case
the block name must be previously defined. Hence the order
of the blocks may be significant.</p>

<h2>CLIENT BLOCK
<a name="CLIENT BLOCK"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>client
(</b><i>name</i><b>|</b><i>fqdn</i><b>|(</b><i>address</i><b>[/</b><i>length</i><b>]))</b>
{</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p>...</p></td></tr>
</table>

<p style="margin-left:9%;">}</p>

<p style="margin-left:9%; margin-top: 1em">The client block
is used to configure a client. That is, tell the proxy about
a client, and what parameters should be used for that
client. The name of the client block must (with one
exception, see below) be either the IP <i>address</i> (IPv4
or IPv6) of the client, an IP prefix (IPv4 or IPv6) on the
form IpAddress/PrefixLength, or a domain name (<i>FQDN</i>).
The way an FQDN is resolved into an IP address may be
influenced by the use of the <b>IPv4Only</b> and
<b>IPv6Only</b> options. Note that literal IPv6 addresses
must be enclosed in brackets.</p>

<p style="margin-left:9%; margin-top: 1em">If a domain name
is specified, then this will be resolved immediately to all
the addresses associated with the name, and the proxy will
not care about any possible DNS changes that might occur
later. Hence there is no dependency on DNS after startup.
However, if the name can not be resolved, startup will
fail.</p>

<p style="margin-left:9%; margin-top: 1em">When some client
later sends a request to the proxy, the proxy will look at
the IP address the request comes from, and then go through
all the addresses of each of the configured clients (in the
order they are defined), to determine which (if any) of the
clients this is. When using the IpAddress/PrefixLength form,
this might mask clients defined later, which then will never
be matched.</p>

<p style="margin-left:9%; margin-top: 1em">In the case of
TLS/DTLS, the name of the client must match the FQDN or IP
address in the client certificate (CN or SubectAltName:DNS
or SubjectAltName:IP respectively) and any
<b>MatchCertificateAttribute</b> to be positively
identified. Note that no FQDN/IP is checked when using an IP
prefix. If overlapping clients are defined (see section
above), they will be searched for positive identification,
but only among clients referencing the same tls block
(selected by the first matching IP address or prefix).</p>

<p style="margin-left:9%; margin-top: 1em">The allowed
options in a client block are:</p>

<p style="margin-left:9%; margin-top: 1em"><b>Host
(</b><i>fqdn</i><b>|(</b><i>address</i><b>[/</b><i>length</i><b>]))</b></p>

<p style="margin-left:18%;">Alternatively of specifying the
FQDN or address in the block name, the <b>host</b> option
may be used. In that case, the value of the <b>host</b>
option is used as described above, while the name of the
block is only used as a descriptive name for the
administrator. The host option may be used multiple times,
and can be a mix of addresses, FQDNs and prefixes.</p>

<p style="margin-left:9%; margin-top: 1em"><b>IPv4Only
(</b>on<b>|</b>off<b>) <br>
IPv6Only (</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enabling IPv4Only or IPv6Only
(on) makes radsecproxy resolve DNS names to the
corresponding address family only, and not the other. At
most one of IPv4Only and IPv6Only can be enabled. Note that
this will override the global option for this client.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Type</b>
<i>type</i></p>

<p style="margin-left:18%;">Specify the <i>type</i>
(protocol) of the client. Available options are <b>UDP</b>,
<b>TCP</b>, <b>TLS</b> and <b>DTLS</b>. <br>
While TLS and DTLS are secure, enctrypted transports, UDP
and TCP are not. Radius uses the shared secret only to
encrypt certain critical attributes, but most of the Radius
data is sent in clear. Protection against manipulation is
only provided if the client uses the Message-Authenticator
attribute. <br>
Therefore UDP and TCP should only be used in secured
networks or when an underying secure transport such as IPSEC
or MACSEC is used. UDP and TCP SHOULD NOT be used across the
internet.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Secret</b>
<i>secret</i></p>

<p style="margin-left:18%;">Use <i>secret</i> as the shared
RADIUS key with this client. If the secret contains
whitespace, the value must be quoted. This option is
optional for TLS/DTLS and if omitted will default to
&quot;radsec&quot;. (Note that using a secret other than
&quot;radsec&quot; for TLS is a violation of the standard
(RFC 6614) and that the proposed standard for DTLS
stipulates that the secret must be
&quot;radius/dtls&quot;.)</p>

<p style="margin-left:9%; margin-top: 1em"><b>TLS</b>
<i>tls</i></p>

<p style="margin-left:18%;">For a TLS/DTLS client you may
also specify the <b>tls</b> option. The option value must be
the name of a previously defined TLS block. If this option
is not specified, the TLS block with the name
<b>defaultClient</b> or <b>default</b> will be used if
defined (in that order). If the specified TLS block name
does not exist, or the option is not specified and none of
the defaults exist, the proxy will exit with an error.</p>


<p style="margin-left:9%; margin-top: 1em"><b>ServerName</b>
<i>servername</i></p>

<p style="margin-left:18%;">Use <i>servername</i> for the
certificate name check instead of <b>host</b> or the client
block name (e.g. if <b>host</b> uses static IP address).</p>


<p style="margin-left:9%; margin-top: 1em"><b>CertificateNameCheck
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">For a TLS/DTLS client, disable
the default behaviour of matching CN or SubjectAltName
against the specified hostname or IP address.</p>


<p style="margin-left:9%; margin-top: 1em"><b>MatchCertificateAttribute</b>
CN:/<i>regexp</i>/ <b><br>
MatchCertificateAttribute</b>
SubjectAltName:DNS:/<i>regexp</i>/ <b><br>
MatchCertificateAttribute</b>
SubjectAltName:URI:/<i>regexp</i>/ <b><br>
MatchCertificateAttribute</b>
SubjectAltName:IP:<i>address</i> <b><br>
MatchCertificateAttribute</b> SubjectAltName:rID:<i>oid</i>
<b><br>
MatchCertificateAttribute</b>
SubjectAltName:otherName:<i>oid</i>:/<i>regexp</i>/</p>

<p style="margin-left:18%;">Perform additional validation
of certificate attributes. Currently matching of CN and
SubjectAltName types URI, DNS, IP, rID, and otherName is
supported. If specified multiple times, all terms must match
for the certificate to be considered valid.</p>

<p style="margin-left:9%; margin-top: 1em"><b>PSKkey</b>
<i>key</i></p>

<p style="margin-left:18%;">For TLS, use TLS-PSK (pre
shared key) instead of certificate based authentication. If
specified, <b>PSKidentity</b> must also be provided. The
<i>key</i> must be at least 16 bytes long. To provide the
<i>key</i> in hex, use the %% escaping (see CONFIGURATION
SYNTAX).</p>

<p style="margin-left:18%; margin-top: 1em">In addition to
the psk, peers must also agree on the key derivation hash
function. For this, the server simply uses the hash funciton
of the negotiated cipher as this negotiation must yield a
compatible cipher anyway. To ensure unambiguous cipher and
hash selection, only use ciphers with the same hash function
in the <b>CipherSuites</b> of the <b>tls</b> block. If no
<b>tls</b> block is specified, a default config with SHA256
is used.</p>

<p style="margin-left:18%; margin-top: 1em">Note: only
TLS1.3 PSK is supported and only for TLS, not DTLS (pending
OpenSSL DTLS1.3 support).</p>


<p style="margin-left:9%; margin-top: 1em"><b>PSKidentity</b>
<i>identity</i></p>

<p style="margin-left:18%;">The TLS-PSK <i>identity</i> to
identify the client. When omitted, the <b>client</b>
<i>name</i> is used as the identity. When using TLS-PSK, all
clients are identified by thier PSK identity, however it is
highly recommended to limit the allowed source address(es)
using the <b>Host</b> <i>address</i> option.</p>


<p style="margin-left:9%; margin-top: 1em"><b>DuplicateInterval</b>
<i>seconds</i></p>

<p style="margin-left:18%;">Specify for how many
<i>seconds</i> duplicate checking should be done. If a proxy
receives a new request within a few seconds of a previous
one, it may be treated the same if from the same client,
with the same authenticator etc. The proxy will then ignore
the new request (if it is still processing the previous
one), or returned a copy of the previous reply.</p>

<p style="margin-left:9%; margin-top: 1em"><b>AddTTL</b>
1-255</p>

<p style="margin-left:18%;">The AddTTL option has the same
meaning as the option used in the basic config. See the
<b>BASIC OPTIONS</b> section for details. Any value
configured here overrides the basic one when sending
messages to this client.</p>

<p style="margin-left:9%; margin-top: 1em"><b>TCPKeepalive
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enable TCP keepalive (default
is off). If keepalives are not answered within 30s the
connection is considered lost.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FticksVISCOUNTRY</b>
<i>cc</i></p>

<p style="margin-left:18%;">Sets this client to be eligible
to F-Ticks logging as defined by the <b>FTicksReporting</b>
basic option, and specifies the country to be reported. The
country should be specified by the two-letter country
code.</p>


<p style="margin-left:9%; margin-top: 1em"><b>FticksVISINST</b>
<i>institution</i></p>

<p style="margin-left:18%;">Set the institution to report
in F-Ticks logging. If this option is omitted, the name of
the client block is used.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Rewrite</b>
<i>rewrite</i></p>

<p style="margin-left:18%;">This option is deprecated. Use
<b>rewriteIn</b> instead.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RewriteIn</b>
<i>rewrite</i> <b><br>
RewriteOut</b> <i>rewrite</i></p>

<p style="margin-left:18%;">Apply the operations in the
specified <i>rewrite</i> block on incoming (request) or
outgoing (response) messages from this client. Rewriting
incoming messages is done before, outgoing after other
processing. If the <b>RewriteIn</b> is not configured, the
rewrite blocks <b>defaultClient</b> or <b>default</b> will
be applied if defined. No default blocks are applied for
<b>RewriteOut</b>.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RewriteAttribute
User-Name:/</b><i>regex</i><b>/</b><i>replace</i><b>/</b></p>

<p style="margin-left:18%;">Rewrite the User-Name attribute
in a client request for the request forwarded by the proxy.
The User-Name attribute is written back to the original
value if a matching response is later sent back to the
client. Example usage:</p>


<p style="margin-left:18%; margin-top: 1em">RewriteAttribute
User-Name:/&#710;(.*)@local$/\1@example.com/</p>


<p style="margin-left:9%; margin-top: 1em"><b>RequireMessageAuthenticator
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Require all Access-Requests be
signed with a Message-Authenticator. <br>
This should be enabled if the client is a proxy, or a NAS
known to use Message-Authenticator (e.g. all EAP based NAS
like Wifi). <br>
This setting is ignored when using TLS/DTLS transport.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RequireMessageAuthenticatorProxy
(</b>on<b>|</b>off)</p>

<p style="margin-left:18%;">Require all Access-Requests
containing a Proxy-State attribute to be signed with a
Message-Authenticaor. <br>
This should always be enabled if the client is a NAS. <br>
This setting is ignored when using TLS/DLTS transport or
when <b>RequireMessageAuthenticator</b> is enabled.</p>

<h2>SERVER BLOCK
<a name="SERVER BLOCK"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>server
(</b><i>name</i><b>|((</b><i>fqdn</i><b>|</b><i>address</i><b>)[</b>:<i>port</i><b>]))</b>
{</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p>...</p></td></tr>
</table>

<p style="margin-left:9%;">}</p>

<p style="margin-left:9%; margin-top: 1em">The server block
is used to configure a server. That is, tell the proxy about
a server, and what parameters should be used when
communicating with that server. The name of the server block
must (with one exception, see below) be either the IP
address (IPv4 or IPv6) of the server, or a domain name
(FQDN). If a domain name is specified, then this will be
resolved immediately to all the addresses associated with
the name, and the proxy will not care about any possible DNS
changes that might occur later. Hence there is no dependency
on DNS after startup. If the domain name resolves to
multiple addresses, then for UDP/DTLS the first address is
used. For TCP/TLS, the proxy will loop through the addresses
until it can connect to one of them. The way an FQDN is
resolved into an IP address may be influenced by the use of
the <b>IPv4Only</b> and <b>IPv6Only</b> options.</p>

<p style="margin-left:9%; margin-top: 1em">In the case of
TLS/DTLS, the name of the server must match the FQDN or IP
address in the server certificate.</p>

<p style="margin-left:9%; margin-top: 1em">Note that the
<i>fqdn</i> or <i>address</i> may include a <i>port</i>
number (separated with a column). This port number will then
override the default port or a port option in the server
block. Also note that literal IPv6 addresses must be
enclosed in brackets.</p>

<p style="margin-left:9%; margin-top: 1em">The allowed
options in a server block are:</p>

<p style="margin-left:9%; margin-top: 1em"><b>Host
(</b><i>fqdn</i><b>|</b><i>address</i><b>)[</b>:<i>port</i><b>]</b></p>

<p style="margin-left:18%;">Alternatively of specifying the
FQDN or address in the block name the <b>host</b> option may
be used. In that case, the value of the <b>host</b> option
is used as described above, while the name of the block is
only used as a descriptive name for the administrator. Note
that multiple host options may be used. This will then be
treated as multiple names/addresses for the same server.
When initiating a TCP/TLS connection, all addresses of all
names may be attempted, but there is no failover between the
different host values. For failover use separate server
blocks.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Port</b>
<i>port</i></p>

<p style="margin-left:18%;">Specify the <i>port</i>
(UDP/TCP) to connect to. If omitted, UDP and TCP will
default to 1812 while TLS and DTLS will default to 2083.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Source
(</b><i>address</i><b>|</b>*<b>)[</b>:<i>port</i><b>]</b></p>

<p style="margin-left:18%;">Specify the source address
and/or port to use for this server. See <b>Source...</b>
options above.</p>


<p style="margin-left:9%; margin-top: 1em"><b>DynamicLookupCommand</b>
<i>command</i></p>

<p style="margin-left:18%;">Execute the <i>command</i> to
dynamically configure a server for a realm given by the
username field in an Access-Request. The command can take
two special forms, naptr:<i>service</i> or
srv:<i>prefix</i>, or point to a script or executable.</p>

<p style="margin-left:18%; margin-top: 1em">The
<b>naptr:</b> and <b>srv:</b> forms execute the
corresponding DNS queries, either searching for
<i>service</i> in NAPTR records (followed by SRV query), or
querying for <i>prefix</i><b>.realm</b> SRV records. Finally
a server block will be constructed for the dynamic realm
taking this server block as a template and overriding the
<b>host</b> entries with the content of the SRV records.</p>

<p style="margin-left:18%; margin-top: 1em">Otherwise, the
<i>command</i> should be an executable file or script, given
with full path, that will be invoked with the name of the
realm as its first and only argument. It should either print
a valid <b>server {...}</b> block containing at least one
<b>host</b> statement on stdout and exit with a code of 0,
or print nothing and exit with a non-zero exit code. If the
command exited with 0 and provided a valid server config, it
will be combined with the statements in this server block,
with the values returned by the command taking
preference.</p>

<p style="margin-left:18%; margin-top: 1em">An example of a
shell script resolving the DNS NAPTR records for the realm
and then the SRV records for each NAPTR matching
&rsquo;x-eduroam:radius.tls&rsquo; is provided in
<i>tools/naptr&minus;eduroam.sh</i>. This is equivalent to
configuring &rsquo;naptr:x-eduroam:radius.tls&rsquo;
directly.</p>


<p style="margin-left:9%; margin-top: 1em"><b>ServerName</b>
<i>servername</i></p>

<p style="margin-left:18%;">Use <i>servername</i> for the
certificate name check instead of <b>host</b> or the server
block name (e.g. if <b>host</b> uses static IP address).
Additionally, this name is used for SNI (if enabled), unless
<b>SNIservername</b> is set.</p>

<p style="margin-left:9%; margin-top: 1em"><b>SNI
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Override gobal SNI setting (see
above). This is implicitly enabled if <b>SNIservername</b>
is set.</p>


<p style="margin-left:9%; margin-top: 1em"><b>SNIservername</b>
<i>sni</i></p>

<p style="margin-left:18%;">Explicitly set the <i>sni</i>
to request from the server, in case the server is specified
by IP address or to override the hostname. Implicitly
enables <b>SNI</b> for this server.</p>

<p style="margin-left:9%; margin-top: 1em"><b>PSKkey</b>
<i>key</i> <b><br>
PSKidentity</b> <i>identity</i></p>

<p style="margin-left:18%;">The meaning of these options
are very similar as for the client block, with minor
differences. <br>
- The <i>identity</i> must always be provided and cannot be
derived from the <b>server</b> <i>name</i>. <br>
- For the key derivation hash funciton, the hash function of
the first cipher in the <b>CipherSuites</b> of the
referenced <b>tls</b> block is used.</p>

<p style="margin-left:9%; margin-top: 1em"><b>StatusServer
(</b>on<b>|</b>off<b>|</b>minimal<b>|</b>auto<b>)</b></p>

<p style="margin-left:18%;">Enable the use of status-server
messages for this server (default <b>off</b>). If
statusserver is enabled (<b>on</b>), the proxy will send
regular status-server messages to the server to verify that
it is alive. Status tracking of the server will solely
depend on status-server message and ignore lost requests.
This should only be enabled if the server supports it. With
the option <b>minimal</b> status-server messages are only
sent when regular requests have been lost and no other
replies have been received.</p>

<p style="margin-left:18%; margin-top: 1em">The option
<b>auto</b> tries to detect whether the other server
supports status-server. If so, status-server messages are
enabled in <b>minimal</b> mode.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RetryCount</b>
<i>count</i></p>

<p style="margin-left:18%;">Set how many times the proxy
should retry sending a request to the server. Default is 2
retries for UDP and DTLS. For TCP and TLS it is always 0.
<br>
Retries from radius clients are ignored and radsecproxy
performs its own retry handling since the requiremets differ
when switching transport protocols.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RetryInterfval</b>
<i>interval</i></p>

<p style="margin-left:18%;">Set the interval between each
retry. Default is 5s.</p>

<p style="margin-left:9%; margin-top: 1em"><b>Rewrite</b>
<i>rewrite</i></p>

<p style="margin-left:18%;">This option is deprecated. Use
<b>rewriteIn</b> instead.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RewriteOut</b>
<i>rewrite</i> <b><br>
RewriteIn</b> <i>rewrite</i></p>

<p style="margin-left:18%;">Apply the operations in the
specified <i>rewrite</i> block on outgoing (request) or
incoming (response) messages to/from this server. Rewriting
outgoing messages is done after, incoming before other
processing. If the <b>RewriteIn</b> is not configured, the
rewrite blocks <b>defaultServer</b> or <b>default</b> will
be applied if defined. No default blocks are applied for
<b>RewriteOut</b>.</p>


<p style="margin-left:9%; margin-top: 1em"><b>LoopPrevention
(</b>on<b>|</b>off)</p>

<p style="margin-left:18%;">This overrides the global
<b>LoopPrevention</b> option for this server. See section
<b>BASIC OPTIONS</b> for details on this option.</p>


<p style="margin-left:9%; margin-top: 1em"><b>BlockingStartup
(</b>on<b>|</b>off)</p>

<p style="margin-left:18%;">Start the dynamic server in
blocking mode (default off), treating it as if it was
already connected and enqueue requests to this server.
Queued requests will be sent out when the connection is
established. If however the dynamic lookup or the connection
fails, the queued requests will be lost. (This is only
considered for dynamic lookup servers. Ie when
DynamicLookupCommand is specified) Warning: when the dynamic
lookup and connection process is slow, this wil block the
respective realm for that time.</p>


<p style="margin-left:9%; margin-top: 1em"><b>DTLSForceMTU</b>
<i>mtu</i></p>

<p style="margin-left:18%;">Some non-Linux platforms are
unable to query the MTU of a connection, causing DTLS to
limit itself to 256 bytes and thus failing to connect.
Manually set <i>mtu</i> to a large enough value so the
initial DTLS client-hello fits without fragmentation.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RequireMessageAuthenticator
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Require all responses to
Access-Requests be signed with a Message-Authenticator. <br>
This should always be be enabled unless the server is known
to only support legacy RADIUS/UDP behavior. <br>
This setting is ignored when using TLS/DTLS transport.</p>

<p style="margin-left:9%; margin-top: 1em">The meaning and
syntax of the following options are exactly the same as for
the client block. The details are not repeated here. Please
refer to the definitions in the <b>CLIENT BLOCK</b>
section.</p>

<p style="margin-left:9%; margin-top: 1em"><b>IPv4Only
(</b>on<b>|</b>off<b>) <br>
IPv6Only (</b>on<b>|</b>off<b>) <br>
Type</b> <i>type</i> <b><br>
Secret</b> <i>secret</i> <b><br>
TLS</b> <i>tls</i> <b><br>
CertificateNameCheck (</b>on<b>|</b>off<b>) <br>
MatchCertificateAttribute</b> ... <b><br>
AddTTL</b> 1-255 <b><br>
TCPKeepalive (</b>on<b>|</b>off<b>)</b></p>

<h2>REALM BLOCK
<a name="REALM BLOCK"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>realm
(</b>*<b>|</b><i>realm</i><b>|</b>/<i>regex</i>/<b>)</b>
{</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p>...</p></td></tr>
</table>

<p style="margin-left:9%;">}</p>

<p style="margin-left:9%; margin-top: 1em">When the proxy
receives an Access-Request it needs to figure out to which
server it should be forwarded. This is done by looking at
the Username attribute in the request, and matching that
against the names of the defined realm blocks. The proxy
will match against the blocks in the order they are
specified, using the first match if any. If no realm
matches, the proxy will simply ignore the request. Each
realm block specifies what the server should do when a match
is found.</p>

<p style="margin-left:9%; margin-top: 1em">The allowed
options in a realm block are:</p>

<p style="margin-left:9%; margin-top: 1em"><b>Server</b>
<i>server</i> <b><br>
AccountingServer</b> <i>server</i></p>

<p style="margin-left:18%;">Specify the <i>server</i> to
which requests for this realm should be forwarded.
<i>server</i> references a previously defined <b>server</b>
block (see the <b>SERVER BLOCK</b> section). Each
<b>server</b> and <b>accountingServer</b> can be specified
multiple times, or omitted completely. If no <b>server</b>
is configured, the proxy will deny all Access-Requests for
this realm. If no <b>accountingServer</b> is configured, the
proxy will silently ignore all Accounting-Requests for this
realm. See the <b>SERVER SELECTION</b> section below for
details.</p>


<p style="margin-left:9%; margin-top: 1em"><b>AccountingResponse
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enable sending
Accounting-Response instead of ignoring Accounting-Requests
when no <b>accoutingServer</b> are configured.</p>


<p style="margin-left:9%; margin-top: 1em"><b>AccountingLog
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">When responding to
Accounting-Requests (<b>AccountingResponse on</b>), log the
accounting data.</p>


<p style="margin-left:9%; margin-top: 1em"><b>ReplyMessage</b>
<i>message</i></p>

<p style="margin-left:18%;">Specify a message to be sent
back to the client if a Access-Request is denied because no
<b>server</b> are configured.</p>

<h3>REALM BLOCK NAMES AND MATCHING
<a name="REALM BLOCK NAMES AND MATCHING"></a>
</h3>


<p style="margin-left:9%; margin-top: 1em">In the general
case the proxy will look for a <b>@</b> in the username
attribute, and try to do an exact, case insensitive match
between what comes after the @ and the name of the realm
block. So if you get a request with the attribute value
anonymous@example.com, the proxy will go through the realm
names in the order they are specified, looking for a realm
block named example.com.</p>

<p style="margin-left:9%; margin-top: 1em">There are two
exceptions to this, one is the realm name <b>*</b> which
means match everything. Hence if you have a realm block
named *, then it will always match. This should then be the
last realm block defined, since any blocks after this would
never be checked. This is useful for having a default.</p>

<p style="margin-left:9%; margin-top: 1em">The other
exception is regular expression matching. If the realm name
starts with a <b>/</b>, the name is treated as an regular
expression. A case insensitive regexp match will then be
done using this regexp on the value of the entire Username
attribute. Optionally you may also have a trailing / after
the regexp. So as an example, if you want to use regexp
matching the domain example.com you could have a realm block
named /@example\.com$/. If you want to match all domains
under the .com top domain, you could do /@.*\.com$/. Note
that since the matching is done on the entire attribute
value, you can also use rules like
/&#710;[a&minus;k].*@example\.com$/ to get some of the users
in this domain to use one server, while other users could be
matched by another realm block and use another server.</p>

<h3>SERVER SELECTION
<a name="SERVER SELECTION"></a>
</h3>


<p style="margin-left:9%; margin-top: 1em">Normally
requests will be forwarded to the first server option
defined. If there are multiple server options, the proxy
will do fail-over and use the second server if the first is
down. If the two first are down, it will try the third etc.
If the first server comes back up, it will go back to using
that one. Detection of servers being up or down is based on
the use of StatusServer (if enabled), and that TCP/TLS/DTLS
connections are up. Otherwise unanswered requests are used
to detect unresponsive servers. AccountingServers are
treated the same, but independently of the other
servers.</p>

<p style="margin-left:9%; margin-top: 1em">If there is no
<b>Server</b> option (or all dynamic lookups have failed),
the proxy will if <b>ReplyMessage</b> is specified, reply
back to the client with an Access Reject message. The
message contains a replyMessage attribute with the value as
specified by the <b>ReplyMessage</b> option. Note that this
is different from having no match since then the request is
simply ignored. This can be used to catch all undefined
sub-domains or even all undefined realms by configuring
either a regex match like /@.*\.example\.com/ or the realm
<b>*</b> with no server option. Another use-case is to block
a specific pattern in the username or realm part using a
regex.</p>

<p style="margin-left:9%; margin-top: 1em">If there is no
<b>AccountingServer</b> option, the proxy will normally do
nothing, ignoring accounting requests. If instead
<b>AccountingResponse</b> is set to on, the proxy will log
some of the accounting information and send an
Accounting-Response back. This stops clients from
retransmitting Accounting-Request messages when a realm has
no accountingServer configured.</p>

<h2>TLS BLOCK
<a name="TLS BLOCK"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>tls</b>
<i>name</i> {</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p>...</p></td></tr>
</table>

<p style="margin-left:9%;">}</p>

<p style="margin-left:9%; margin-top: 1em">The TLS block
specifies TLS configuration options and you need at least
one of these if you have clients or servers using TLS/DTLS.
As discussed in the client and server block descriptions, a
client or server block may reference a particular TLS block
by name. There are also however the special TLS block names
<b>default</b>, <b>defaultClient</b> and
<b>defaultServer</b> which are used as defaults if the
client or server block does not reference a TLS block. Also
note that a TLS block must be defined before the client or
server block that would use it. If you want the same TLS
configuration for all TLS/DTLS clients and servers, you need
just a single tls block named <b>default</b>, and the client
and servers need not refer to it. If you want all TLS/DTLS
clients to use one config, and all TLS/DTLS servers to use
another, then you would be fine only defining two TLS blocks
named <b>defaultClient</b> and <b>defaultServer</b>. If you
want different clients (or different servers) to have
different TLS parameters, then you may need to create other
TLS blocks with other names, and reference those from the
client or server definitions.</p>

<p style="margin-left:9%; margin-top: 1em">As both clients
and servers need to present and verify a certificate, both a
certificate as well as a CA to verify the peers certificate
must be configured.</p>

<p style="margin-left:9%; margin-top: 1em">The allowed
options in a tls block are:</p>


<p style="margin-left:9%; margin-top: 1em"><b>CACertificateFile</b>
<i>file</i></p>

<p style="margin-left:18%;">The CA certificate file used to
verify the peers certificate. The <i>file</i> can include
multiple certificates as well as CRLs.</p>


<p style="margin-left:9%; margin-top: 1em"><b>CACertificatePath</b>
<i>path</i></p>

<p style="margin-left:18%;">The path to search for CA or
intermediate certificates and CRLs. All files must have
hashed symbolic links to be found. See
<b>openssl-rehash</b>(1).</p>


<p style="margin-left:9%; margin-top: 1em"><b>CertificateFile</b>
<i>file</i></p>

<p style="margin-left:18%;">The server certificate this
proxy will use. The file may also contain a certificate
chain. Any missing certificates to complete the chain will
be searched for in the <b>CACertificateFile</b> and
<b>CACertificatePath</b>.</p>


<p style="margin-left:9%; margin-top: 1em"><b>CertificateKeyFile</b>
<i>file</i></p>

<p style="margin-left:18%;">The private-key file for the
server certificate specified in
<b>CACertificateFile</b>.</p>


<p style="margin-left:9%; margin-top: 1em"><b>CertificateKeyPassword</b>
<i>password</i></p>

<p style="margin-left:18%;">The password to decrypt the
private-key.</p>


<p style="margin-left:9%; margin-top: 1em"><b>PolicyOID</b>
<i>oid</i></p>

<p style="margin-left:18%;">Require the peers certificate
to adhere to the policy specified by <i>oid</i>. When
specified multiple times at least one policy must be valid
in the peer certificate.</p>

<p style="margin-left:9%; margin-top: 1em"><b>CRLCheck
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enable checking peer
certificate against the CRL (default off). Note if enabled,
all CAs in this context MUST provide a CRL, otherwise they
are considered untrusted. <br>
Note that radsecproxy does not fetch the CRLs itself. This
has to be done separately, e.g. with <b>fetch-crl</b>(8)</p>


<p style="margin-left:9%; margin-top: 1em"><b>CacheExpiry</b>
<i>seconds</i></p>

<p style="margin-left:18%;">Specify how many <i>seconds</i>
the CA and CRL information should be cached. By default, the
CA and CRL are loaded at startup and cached indefinetely.
After the configured time, the CA and CRL are re-read.
Alternatively, reloading the CA and CRL can be triggered by
sending a SIGHUP to the radsecproxy process. This option may
be set to zero to disable caching, but be warned: this might
have a huge performance impact. <br>
Any negative value will disable the cache expiry.</p>


<p style="margin-left:9%; margin-top: 1em"><b>CipherList</b>
<i>ciphers</i></p>

<p style="margin-left:18%;">Specify the list of accepted
<i>ciphers</i>. See <b>openssl-ciphers</b>(1).</p>


<p style="margin-left:9%; margin-top: 1em"><b>CipherSuites</b>
<i>ciphersuites</i></p>

<p style="margin-left:18%;">Specify the <i>ciphersuites</i>
to be used for TLS1.3. See <b>openssl-ciphers</b>(1). <br>
Note this requires OpenSSL 1.1.1</p>


<p style="margin-left:9%; margin-top: 1em"><b>TlsVersion</b>
( <i>version</i> | <i>minversion</i>:<i>maxversion</i> )
<b><br>
DtlsVersion</b> ( <i>version</i> |
<i>minversion</i>:<i>maxversion</i> )</p>

<p style="margin-left:18%;">Specify the TLS/DTLS protocol
<i>version</i> to be used. <br>
Specify the range of allowed protocol versions between
<i>minversion</i> and <i>maxversion</i> (inclusive). If
either is left out, any version up to, or starting from this
version is allowed. E.g. &quot;TLS1_2:&quot; will allow
TLSv1.2 or later. If omitted, use the system defaults set in
openssl.conf <br>
Currently supported values are
<b>SSL3</b>,<b>TLS1</b>,<b>TLS1_1</b>,<b>TLS1_2</b>,<b>TLS1_3</b>
for TLS and <b>DTLS1</b>,<b>DTLS1_2</b> for DTLS.</p>

<p style="margin-left:9%; margin-top: 1em"><b>DhFile</b>
<i>file</i></p>

<p style="margin-left:18%;">DH parameter <i>file</i> to
use. See <b>openssl-dhparam</b>(1) <br>
Note: starting with OpenSSL 3.0, use of custom DH parameters
is discouraged.</p>

<h2>REWRITE BLOCK
<a name="REWRITE BLOCK"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>rewrite</b>
<i>name</i> {</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p>...</p></td></tr>
</table>

<p style="margin-left:9%;">}</p>

<p style="margin-left:9%; margin-top: 1em">The rewrite
block specifies rules that may rewrite RADIUS messages. It
can be used to add, remove and modify specific attributes
from messages received from and sent to clients and servers.
As discussed in the client and server block descriptions, a
client or server block may reference a particular rewrite
block by name. There are however also the special rewrite
block names <b>default</b>, <b>defaultClient</b> and
<b>defaultServer</b> which are used as defaults if the
client or server block does not reference a block. Also note
that a rewrite block must be defined before the client or
server block that would use it. If you want the same rewrite
rules for input from all clients and servers, you need just
a single rewrite block named <b>default</b>, and the client
and servers need not refer to it. If you want all clients to
use one config, and all servers to use another, then you
would be fine only defining two rewrite blocks named
<b>defaultClient</b> and <b>defaultServer</b>. Note that
these defaults are only used for rewrite on input. No
rewriting is done on output unless explicitly specified
using the <b>RewriteOut</b> option.</p>

<p style="margin-left:9%; margin-top: 1em">The rewrite
actions are performed in this sequence:</p>

<p style="margin-left:18%;">1. RemoveAttribute (or
WhitelistAttribute) <br>
2. ModifyAttribute <br>
3. SupplementAttribute <br>
4. AddAttribute</p>

<p style="margin-left:9%; margin-top: 1em">All options can
be specified multiple times. The allowed options in a
rewrite block are:</p>


<p style="margin-left:9%; margin-top: 1em"><b>AddAttribute</b>
<i>attribute</i>:<i>value</i></p>

<p style="margin-left:18%;">Add an <i>attribute</i> to the
radius message and set it to <i>value</i>. The
<i>attribute</i> must be specified using the numerical
attribute id. The <i>value</i> can either be numerical, a
string, or a hex value. If the value starts with a number,
it is interpreted as a 32bit unsigned integer. Use the
&rsquo; character at the start of the value to force string
interpretation. When using hex value, it is recommended to
also lead with &rsquo; to avoid unintended numeric
interpretation. See the <b>CONFIGURATION SYNTAX</b> section
for further details.</p>


<p style="margin-left:9%; margin-top: 1em"><b>AddVendorAttribute</b>
<i>vendor</i>:<i>subattribute</i>:<i>value</i></p>

<p style="margin-left:18%;">Add a vendor attribute to the
radius message, specified by <i>vendor</i> and
<i>subattribute</i>. Both <i>vendor</i> and
<i>subattribute</i> must be specified as numerical values.
The format of <i>value</i> is the same as for
<b>addAttribute</b> above.</p>


<p style="margin-left:9%; margin-top: 1em"><b>SupplementAttribute</b>
<i>attribute</i>:<i>value</i></p>

<p style="margin-left:18%;">Add an <i>attribute</i> to the
radius message and set it to <i>value</i>, only if the
attribute is not yet present on the message. The format of
<i>value</i> is the same as for <b>addAttribute</b>
above.</p>


<p style="margin-left:9%; margin-top: 1em"><b>SupplementVendorAttribute</b>
<i>vendor</i>:<i>subattribute</i>:<i>value</i></p>

<p style="margin-left:18%;">Add a vendor attribute to the
radius message only if the <i>subattribute</i> of this
<i>vendor</i> is not yet present on the message. The format
of is the same as for <b>addVendorAttribute</b> above.</p>


<p style="margin-left:9%; margin-top: 1em"><b>ModifyAttribute</b>
<i>attribute</i>:/<i>regex</i>/<i>replace</i>/</p>

<p style="margin-left:18%;">Modify the given
<i>attribute</i> using the <i>regex replace</i> pattern. As
above, <i>attribute</i> must be specified by a numerical
value. Example usage:</p>


<p style="margin-left:18%; margin-top: 1em">modifyAttribute
1:/&#710;(.*)@local$/\1@example.com/</p>


<p style="margin-left:9%; margin-top: 1em"><b>ModifyVendorAttribute</b>
<i>vendor</i>:<i>subattribute</i>:/<i>regex</i>/<i>replace</i>/</p>

<p style="margin-left:18%;">Modify the given
<i>subattribute</i> of given <i>vendor</i> using the
<i>regex replace</i> pattern. Other than the added vendor,
the same syntax as for <b>ModifyAttribute</b> applies.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RemoveAttribute</b>
<i>attribute</i></p>

<p style="margin-left:18%;">Remove all attributes with the
given id.</p>


<p style="margin-left:9%; margin-top: 1em"><b>RemoveVendorAttribute</b>
<i>vendor</i><b>[</b>:<i>subattribute</i><b>]</b></p>

<p style="margin-left:18%;">Remove all vendor attributes
that match the given <i>vendor</i> and <i>subattribute</i>.
If the <i>subattribute</i> is omitted, all attributes with
the given vendor id are removed.</p>


<p style="margin-left:9%; margin-top: 1em"><b>WhitelistMode
(</b>on<b>|</b>off<b>)</b></p>

<p style="margin-left:18%;">Enable whitelist mode. All
attributes except those configured with
<b>WhitelistAttribute</b> or <b>WhitelistVendorAttribute</b>
will be removed. While whitelist mode is active,
<b>RemoveAttribute</b> and <b>RemoveVendorAttribute</b>
statements are ignored.</p>


<p style="margin-left:9%; margin-top: 1em"><b>WhitelistAttribute</b>
<i>attribute</i></p>

<p style="margin-left:18%;">Do not remove attributes with
the given id when <b>WhitelistMode</b> is on. Ignored
otherwise.</p>


<p style="margin-left:9%; margin-top: 1em"><b>WhitelistVendorAttribute</b>
<i>vendor</i><b>[</b>:<i>subattribute</i><b>]</b></p>

<p style="margin-left:18%;">Do not remove vendor attributes
that match the given <i>vendor</i> and <i>subattribute</i>
when <b>WhitelistMode</b> is on. Ignored otherwise.</p>

<p style="margin-left:18%; margin-top: 1em">If the
<i>subattribute</i> is omitted, the complete vendor
attribute is whitelisted. Otherwise only the specified
subattribute is kept but all other subattributes are
removed.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>radsecproxy</b>(8)</p>
<hr>
</body>
</html>
